!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).routerHelper=e()}(this,(function(){"use strict";return function(t,e,n){var o;void 0===n&&(n=!1),e._stack=0;var r=!1;e.beforeEach((function(t,e,n){o=a(),n()})),e.afterEach((function(e,n){t.nextTick((function(){void 0===o?p(e):r?h():k(e)?f():v(),d()}))}));var c=e.replace;if(e.replace=function(t,n,o){r=!0,c.apply(e,[arguments[0]])},n){var i=e.push;e.push=function(t,o,r){if(n){var c=a();"string"==typeof t?t=-1!==t.indexOf("?")?t+"&routerStack="+(c._stack+1):t+"?routerStack="+(c._stack+1):t.query?t.query.routerStack=c._stack+1:t.query={routerStack:c._stack+1}}i.apply(e,[arguments[0]])}}var a=function(){return e.history.current.matched.length>0?e.history.current.matched[0].instances.default:void 0},s=function(){return a()?a()._stack:void 0},u=function(t){e.history.current.matched.length>0&&(e.history.current.matched[0].instances.default._stack=Number(t))},d=function(){var t=a();t&&t._vnode&&(t._vnode.key=Number(t._stack)+e.history.current.path)},p=function(t){n&&t.query&&void 0!==t.query.routerStack?(u(t.query.routerStack),e._stack=t.query.routerStack):u(0)},f=function(){e._stack++,u(e._stack)},v=function(){e._stack--,void 0===s()&&u(o._stack-1),o.$keepAliveDestroy()},h=function(){u(o._stack),o.$keepAliveDestroy(),r=!1},k=function(t){var e=t.query&&void 0!==t.query.routerStack?t.query.routerStack:0;return void 0===s()&&!n||n&&e>o._stack},y=t.prototype.$destroy;t.prototype.$keepAliveDestroy=function(){if(this.$vnode&&this.$vnode.data.keepAlive&&this.$vnode.parent&&this.$vnode.parent.componentInstance&&this.$vnode.parent.componentInstance.cache&&this.$vnode.componentOptions){var t=null==this.$vnode.key?this.$vnode.componentOptions.Ctor.cid+(this.$vnode.componentOptions.tag?"::"+this.$vnode.componentOptions.tag:""):this.$vnode.key,e=this.$vnode.parent.componentInstance.cache,n=this.$vnode.parent.componentInstance.keys;if(e[t]){if(n.length){var o=n.indexOf(t);o>-1&&n.splice(o,1)}delete e[t]}}y.apply(this,arguments)}}}));
//# sourceMappingURL=index.js.map
