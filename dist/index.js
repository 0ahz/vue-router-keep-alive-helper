!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).routerHelper=t()}(this,(function(){"use strict";function e(e){if(void 0!==e.Vue&&void 0!==e.router){var t,n=e.Vue,r=e.router,o=!1;r._stack=0;var c=!1;r.beforeEach((function(e,n,r){t=p(),r()})),r.afterEach((function(e,r){n.nextTick((function(){void 0===t?v(e):c?l():m(e)?k():y(),h();var n=p();o||u(n.$vnode.parent.componentInstance)}))}));var i=r.replace;r.replace=function(e,t,n){c=!0,i.apply(r,[arguments[0]])};var a=r.push;r.push=function(e,t,n){var o=p();"string"==typeof e?e=-1!==e.indexOf("?")?e+"&routerStack="+(o._stack+1):e+"?routerStack="+(o._stack+1):e.query?e.query.routerStack=o._stack+1:e.query={routerStack:o._stack+1},a.apply(r,[arguments[0]])};var u=function(e){_(e,s(r._stack));var t=e.$options.render;e.$options.render=function(){var e=this.$slots.default,n=g(e);return q(n.key)||(c?n.key=s(r._stack):m(r.history.current)?n.key=s(Number(r._stack)+1):n.key=s(Number(r._stack)-1)),t.apply(this,arguments)},o=!0},s=function(e){return"keep-alive"+Number(e)+r.history.current.path},p=function(){return r.history.current.matched.length>0?r.history.current.matched[0].instances.default:void 0},d=function(){return p()?p()._stack:void 0},f=function(e){r.history.current.matched.length>0&&(r.history.current.matched[0].instances.default._stack=Number(e))},h=function(){var e=p();e&&e._vnode&&(e._vnode.key=Number(r._stack)+r.history.current.path,e._vnode.parent.key=s(r._stack))},v=function(e){e.query&&void 0!==e.query.routerStack?(f(e.query.routerStack),r._stack=e.query.routerStack):f(0)},k=function(){r._stack++,f(r._stack)},y=function(){r._stack--,void 0===d()&&f(t._stack-1),t.$keepAliveDestroy()},l=function(){f(t._stack),t.$keepAliveDestroy(),c=!1},m=function(e){var n=e.query&&void 0!==e.query.routerStack?e.query.routerStack:0;return d(),n>t._stack},_=function(e,t){if(q(e)&&q(e.cache)&&q(e.keys)){var n=e.keys,r=e.cache;if(1==n.length){var o=r[n[0]];delete r[n[0]],n.splice(0,1),n.push(t),r[t]=o}}},$=n.prototype.$destroy;n.prototype.$keepAliveDestroy=function(){if(this.$vnode&&this.$vnode.data.keepAlive&&this.$vnode.parent&&this.$vnode.parent.componentInstance&&this.$vnode.parent.componentInstance.cache&&this.$vnode.componentOptions){var e=null==this.$vnode.key?this.$vnode.componentOptions.Ctor.cid+(this.$vnode.componentOptions.tag?"::"+this.$vnode.componentOptions.tag:""):this.$vnode.key,t=this.$vnode.parent.componentInstance.cache,n=this.$vnode.parent.componentInstance.keys;if(t[e]){if(n.length){var r=n.indexOf(e);r>-1&&n.splice(r,1)}delete t[e]}}$.apply(this,arguments)};var g=function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++){var n=e[t];if(q(n)&&(q(n.componentOptions)||b(n)))return n}},b=function(e){return e.isComment&&e.asyncFactory},q=function(e){return null!=e}}else console.warn("warning: router helper needs Vue and root router ,see more for guide : https://github.com/Zippowxk/vue-router-keep-alive-helper")}return"undefined"!=typeof window&&(window.createHelper=e),e}));
//# sourceMappingURL=index.js.map
