!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).routerHelper=t()}(this,(function(){"use strict";function e(e){if(void 0!==e.Vue&&void 0!==e.router){var t,n=e.Vue,o=e.router,r=o.mode,i=e.replaceStay||[],c=!1;o._stack=0;var a=!1,s=void 0,u=0;o.beforeEach((function(e,n,o){t=g(),o()})),o.afterEach((function(e,r){n.nextTick((function(){void 0===t?console.log("init"):a?(h(),console.log("replace")):m()?(d(),console.log("push")):(l(),console.log("back")),u=Number(o._stack),_();var e=g();!c&&e&&f(e.$vnode.parent.componentInstance)}))}));var p=o.replace;o.replace=function(e,t,n){a=!0,s=o.history.current.path,p.apply(o,[arguments[0]])};var d=function(){o._stack++,y(o._stack)},l=function(){o._stack--,t.$keepAliveDestroy()},h=function(){A(s)&&-1!=i.indexOf(s)||t.$keepAliveDestroy(),a=!1,s=void 0},f=function(e){w(e,$(o._stack));var t=e.$options.render;e.$options.render=function(){var e=this.$slots.default,n=O(e);return A(n.key)||(a?n.key=$(o._stack):m()?n.key=$(Number(o._stack)+1):n.key=$(Number(o._stack)-1)),t.apply(this,arguments)},c=!0},v=function(){var e=k();return A(e)?e.id:void 0},y=function(e){console.log(o.history.current.path);var t=("hash"===r?"#":"")+o.history.current.path;window.location.href.startsWith("file://")&&(t=("hash"===r?window.location.href.split("#")[0]:window.location.href.splice(".html")[0]+".html")+t,console.log(t));history.replaceState({id:e},"",t)},k=function(){return history.state},m=function(){return!a&&(!A(v())||u<v())},$=function(e){return"keep-alive-vnode-key"+Number(e)+o.history.current.path},g=function(){return o.history.current.matched.length>0?o.history.current.matched[0].instances.default:void 0},_=function(){var e,t=g();t&&t._vnode&&(t._vnode.key=(e=o._stack,"vnode-key"+Number(e)+o.history.current.path),t._vnode.parent.key=$(o._stack))},w=function(e,t){if(A(e)&&A(e.cache)&&A(e.keys)){var n=e.keys,o=e.cache;if(1==n.length){var r=o[n[0]];delete o[n[0]],n.splice(0,1),n.push(t),o[t]=r}}},b=n.prototype.$destroy;n.prototype.$keepAliveDestroy=function(){if(this.$vnode&&this.$vnode.data.keepAlive&&this.$vnode.parent&&this.$vnode.parent.componentInstance&&this.$vnode.parent.componentInstance.cache&&this.$vnode.componentOptions){var e=null==this.$vnode.key?this.$vnode.componentOptions.Ctor.cid+(this.$vnode.componentOptions.tag?"::"+this.$vnode.componentOptions.tag:""):this.$vnode.key,t=this.$vnode.parent.componentInstance.cache,n=this.$vnode.parent.componentInstance.keys;if(t[e]){if(n.length){var o=n.indexOf(e);o>-1&&n.splice(o,1)}delete t[e]}}b.apply(this,arguments)};var O=function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++){var n=e[t];if(A(n)&&(A(n.componentOptions)||x(n)))return n}},x=function(e){return e.isComment&&e.asyncFactory},A=function(e){return null!=e}}else console.warn("warning: router helper needs Vue and root router ,see more for guide : https://github.com/Zippowxk/vue-router-keep-alive-helper")}return"undefined"!=typeof window&&(window.createHelper=e),e}));
//# sourceMappingURL=index.js.map
