!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).routerHelper=t()}(this,(function(){"use strict";function e(e){if(void 0!==e.Vue&&void 0!==e.router){var t,n=e.Vue,o=e.router,r=void 0===e.canRefresh||e.canRefresh,c=!1;o._stack=0;var i=!1;o.beforeEach((function(e,n,o){t=p(),o()})),o.afterEach((function(e,o){n.nextTick((function(){void 0===t?f(e):i?(k(),console.log("replace")):m(e)?(v(),console.log("push")):(y(),console.log("back")),h();var n=p();console.log(n.$vnode.parent.componentInstance.cache),console.log(n.$vnode.parent.componentInstance.keys),c||u(n.$vnode.parent.componentInstance)}))}));var a=o.replace;if(o.replace=function(e,t,n){i=!0,a.apply(o,[arguments[0]])},r){var s=o.push;o.push=function(e,t,n){if(r){var c=p();"string"==typeof e?e=-1!==e.indexOf("?")?e+"&routerStack="+(c._stack+1):e+"?routerStack="+(c._stack+1):e.query?e.query.routerStack=c._stack+1:e.query={routerStack:c._stack+1}}s.apply(o,[arguments[0]])}}var u=function(e){g(e,"keep-alive"+Number(o._stack)+o.history.current.path);var t=e.$options.render;e.$options.render=function(){var e=this.$slots.default,n=_(e);return console.log("====================================!!!"),console.log("===================================="),console.log(o.history),q(n.key)||(i?n.key="keep-alive"+Number(o._stack)+o.history.current.path:m(o.history.current)?n.key="keep-alive"+Number(Number(o._stack)+1)+o.history.current.path:n.key="keep-alive"+Number(Number(o._stack)-1)+o.history.current.path),console.log(o.history.current.path),console.log(n),t.apply(this,arguments)},c=!0},p=function(){return o.history.current.matched.length>0?o.history.current.matched[0].instances.default:void 0},l=function(){return p()?p()._stack:void 0},d=function(e){o.history.current.matched.length>0&&(o.history.current.matched[0].instances.default._stack=Number(e))},h=function(){var e=p();e&&e._vnode&&(e._vnode.key=Number(o._stack)+o.history.current.path,e._vnode.parent.key="keep-alive"+e._vnode.key)},f=function(e){r&&e.query&&void 0!==e.query.routerStack?(d(e.query.routerStack),o._stack=e.query.routerStack):d(0)},v=function(){o._stack++,d(o._stack)},y=function(){o._stack--,void 0===l()&&d(t._stack-1),t.$keepAliveDestroy()},k=function(){d(t._stack),t.$keepAliveDestroy(),i=!1},m=function(e){var n=e.query&&void 0!==e.query.routerStack?e.query.routerStack:0,o=p();return console.log(o),void 0===l()&&!r||r&&n>t._stack},g=function(e,t){if(q(e)&&q(e.cache)&&q(e.keys)){var n=e.keys,o=e.cache;if(1==n.length){var r=o[n[0]];delete o[n[0]],n.splice(0,1),n.push(t),o[t]=r}}},$=n.prototype.$destroy;n.prototype.$keepAliveDestroy=function(){if(this.$vnode&&this.$vnode.data.keepAlive&&this.$vnode.parent&&this.$vnode.parent.componentInstance&&this.$vnode.parent.componentInstance.cache&&this.$vnode.componentOptions){var e=null==this.$vnode.key?this.$vnode.componentOptions.Ctor.cid+(this.$vnode.componentOptions.tag?"::"+this.$vnode.componentOptions.tag:""):this.$vnode.key,t=this.$vnode.parent.componentInstance.cache,n=this.$vnode.parent.componentInstance.keys;if(t[e]){if(n.length){var o=n.indexOf(e);o>-1&&n.splice(o,1)}delete t[e]}}$.apply(this,arguments)};var _=function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++){var n=e[t];if(q(n)&&(q(n.componentOptions)||b(n)))return n}},b=function(e){return e.isComment&&e.asyncFactory},q=function(e){return null!=e}}else console.warn("warning: router helper needs Vue and root router ,see more for guide : https://github.com/Zippowxk/vue-router-keep-alive-helper")}return"undefined"!=typeof window&&(window.createHelper=e),e}));
//# sourceMappingURL=index.js.map
